rule Cisco_CVE_2023_20178_PoC_Exploit {

  meta:

      date = "2023-06-22"
      description = "Detects CVE-2023-20178 Proof-of-concept exploit code. This is PoC for Arbitrary File Delete vulnerability in Cisco Secure Client (tested on 5.0.01242) and Cisco AnyConnect (tested on 4.10.06079). High-severity flaw in Cisco Secure Client Software for Windows (formerly AnyConnect Secure Mobility Client) that can let attackers elevate privileges to SYSTEM."
      author = "Ahmet Payaslioglu - Binalyze DFIR Lab"
      hash = "524ec21a0c7b86c23ea6f23ee9987a84"
      reference1 = "https://www.bleepingcomputer.com/news/security/exploit-released-for-cisco-anyconnect-bug-giving-system-privileges/"
      reference2 = "https://github.com/Wh04m1001/CVE-2023-20178/tree/main"
      verdict = "dangerous"
      platform = "windows"
      search_context = "filesystem"

  strings:

	$ = "[+] RBS file overwritten!" ascii
	$ = "Failed to create C:\\Config.msi directory." ascii
	$ = "[!] Failed. Cannot remove c:\\Config.msi" ascii
	$ = "C:\\Config.Msi already exists and is not empty" ascii
	$ = "[+] Successfully removed and recreated C:\\Config.Msi" ascii
	$ = "[!] Failed.  C:\\Config.Msi already exists and is not empty" ascii
	$ = "[!] Cannot open directory!" ascii

    condition:

        uint16(0) == 0x5A4D and filesize < 5MB and all of them

}

